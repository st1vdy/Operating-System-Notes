# 进程控制

## 进程创建

创建进程实际上是一个父进程创建一个子进程，当进程创建新进程时，可有两种执行可能：

1. 父进程与子进程并发执行。
2. 父进程等待，直到某个或全部子进程执行完。

新进程的地址空间也有两种可能：

1. 子进程是父进程的复制品（它具有与父进程同样的程序和数据）。
2. 子进程加载另一个新程序。

虽然子进程可能是父进程的复制，但是父进程和子进程拥有独立的地址空间和PID。

进程创建有以下四种情况：

1. 新的批处理作业
2. 交互登录（用户登录到系统）
3. 操作系统提供服务
4. 现有进程派生



### 创建原语

1. 为新进程分配一个唯一的进程标识号，并申请一个空白的PCB
2. 为进程分配运行所需的资源（如果资源尚未满足，则会等待，此时会停在创建态）
3. 初始化PCB
4. 等待进程调度



## 进程终止

进程在以下三种情况下可能终止：

1. 正常结束
2. 异常结束，比如发生了越界等错误。
3. 外界干预，父进程结束时会强行终止子进程。

### 终止原语

1. 根据被终止进程的标识符检索出该进程的PCB
2. 如果该进程还处于运行态，立即终止
3. 终止该进程的所有子孙进程
4. 将该进程所拥有的全部资源归还给父进程或操作系统
5. 将该进程的PCB删除。



## 进程阻塞和唤醒

### 阻塞原语

1. 找到PCB
2. 保护现场
3. 将该PCB插入相应事件的等待队列

### 唤醒原语

1. 找到PCB
2. 从等待队列移除，并设置为就绪态
3. 将PCB插入就绪队列



## 例题

> 下列选项中，导致创建新进程的操作是（）
>
> 1. 用户登陆成功
> 2. 设备分配
> 3. 启动程序执行

1，3.



> 下列选项中，可能会将进程唤醒的事件是（）
>
> 1. I/O结束
> 2. 某进程退出临界区
> 3. 当前进程的时间片用完

唤醒就是从阻塞态变成就绪态，显然选项1、2都是。选项3是从运行态变成就绪态。



> 下列关于父进程与子进程的叙述中，错误的是（）
>
> 1. 父进程与子进程可以并发执行
> 2. 父进程与子进程共享虚拟地址空间
> 3. 父进程与子进程有不同的进程控制块
> 4. 父进程与子进程不能同时使用同一临界资源

选项2错误，子进程可能是父进程的复制，但是内存空间并不共享。