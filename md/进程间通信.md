# 进程间通信

**进程间通信**（英语：**Inter-Process Communication**，简称IPC），指至少两个进程或线程间传送数据或信号的一些技术或方法。

## 共享内存

共享内存就是在内存中划分出一片各个进程可以直接访问的共享空间，对这片共享空间进行读写来实现信息交换。

在读/写共享空间时需要使用同步互斥工具进行控制。



## 消息传递

一般认为有两种实现：**直接通信**和**间接通信**。

**直接通信**可以近似地看成在每对进程之间建立通信链路（发送进程直接把信息发送给接收进程，信息将挂在接收进程的缓冲队列上）；**间接通信**通过一个中介（一般称为邮箱或者端口）来收发信息。



## 管道通信

管道通信指的是利用一个共享文件（pipe文件），该文件连接了一个读进程和一个写进程，发送方会在管道（共享文件）中写入数据，接收方则通过管道接收数据。

> 这个共享文件实际上是在内存中开辟一个大小固定的缓冲区，并不是“真正的文件”。

管道同一时刻中只有一方可以写，另一方可以读，也就是说一个管道只支持半双工通信。如果需要双方能够相互读写，则需要设置两个管道。

管道中的数据一旦被读出，就会彻底消失。因此，多个进程读同一个管道时可能会错乱，这个问题的解决方案如下：

1. 一个管道**允许多个写进程，一个读进程**。
2. 一个管道**允许多个写进程，多个读进程**。但系统会让各个读进程轮流从管道中读数据。



## 例题

> 下列关于管道通信的叙述中，正确的是（）
>
> 1. 一个管道可实现双向数据传输
> 2. 管道的容量仅受磁盘容量大小限制
> 3. 进程对管道进行读操作和写操作都可能被阻塞
> 4. 一个管道只能有一个读进程或一个写进程对其操作

选项1显然错误，管道的工作方式类似于单向队列。

选项2错误，因为管道是内存中大小固定的一片内存缓冲区，与硬盘无关。

选项3正确，读空管道会阻塞；多个写进程同时写会阻塞。

选项4错误，一个管道可能有多个读进程，也可能有多个写进程。